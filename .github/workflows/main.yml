# workflow name
name: Hexo Blog CI

# master branch on push, auto run
on: 
  push:
    branches:
      - master
      
jobs:
  build: 
    runs-on: ubuntu-latest 
        
    steps:
    # check it to your workflow can access it
    # from: https://github.com/actions/checkout
    - name: Checkout Repository master branch
      uses: actions/checkout@master
      
    # from: https://github.com/actions/setup-node  
    - name: Setup Node.js 12.x 
      uses: actions/setup-node@master
      with:
        node-version: 12.x
    
    - name: Setup Hexo Dependencies
      run: |
        npm install --save hexo-deployer-git
        npm install hexo --save
        npm install
        npm test
    
    - name: Setup Deploy Private Key
      env:
        HEXO_DEPLOY_PRIVATE_KEY: '-----BEGIN OPENSSH PRIVATE KEY-----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-----END OPENSSH PRIVATE KEY-----'
        #HEXO_DEPLOY_PRIVATE_KEY: ${{ secrets.HEXO_DEPLOY_PRIVATE_KEY}}
      run: |
        mkdir -p ~/.ssh/
        echo "$HEXO_DEPLOY_PRIVATE_KEY" > ~/.ssh/id_rsa 
        chmod 600 ~/.ssh/id_rsa
        ssh-keyscan github.com >> ~/.ssh/known_hosts
        ssh-keyscan gitee.com >> ~/.ssh/known_hosts
        
    - name: Setup Git Infomation
      run: | 
        git config --global user.name 'Soto.Pu' 
        git config --global user.email 'p709723778@126.com'
    - name: Deploy Hexo
      run: |
        npm run build
        #hexo clean
        #hexo generate 
        #hexo deploy
